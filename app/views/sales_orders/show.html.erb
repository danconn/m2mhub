<%= render 'sales_orders/submenu' %>
<br />

<div class="paging">
	<%= link_to("&laquo; Previous".html_safe, sales_order_url(@next_sales_order.order_number)) if @next_sales_order  %>
	<%= link_to("Next &raquo;".html_safe, 
	sales_order_url(@previous_sales_order.order_number)) if @previous_sales_order %>
</div>

<h2>Sales Order <%= @sales_order.fsono %></h2>
<p>
	Date: <%= @sales_order.order_date.to_s(:sales_date) %><br />
	Status: <%= @sales_order.status %><br />
	Customer: <strong><%= link_to @sales_order.customer_name, customer_number_url(@sales_order.fcustno) %></strong><br />
	Customer PO#: <%= @sales_order.customer_po %><br />
	Total: $<%= cm @sales_order.total_price, :dollars %><br />
	Sales Rep: <%= @sales_order.fsoldby %><br />
	Coord: <%= @sales_order.fsocoord %><br />
</p>

<h3>Releases</h3>
<table class="data">
	<thead>
		<tr>
			<th>Due Date</th>
			<th>Delivery<br />Committment</th>
			<th><%= CompanyConfig.short_name %> Part No.</th>
			<th>Description</th>
			<th>Cust Part No.</th>
			<th>Cost</th>
			<th>Unit Price</th>
			<th>Order<br />Quantity</th>
			<th>On Hand</th>
			<th>Committed</th>
			<th>Total Price</th>
		</tr>
	</thead>
	<tbody>
<% @releases.sort_by(&:due_date).each do |r| %>
		<tr>
			<td><%= r.due_date.to_s(:sales_date) %></td>
			<td><%= h r.fdelivery.strip %></td>
			<% if r.item.nil? %>
			<td colspan="8"></td>
			<% else %>
			<td><%= link_to_item r.item.try(:item), r.part_number %></td>
			<td><%= simple_format r.item.fdesc.strip %></td>
			<td><%= r.item.fcustpart %></td>
			<td class="monitary">$<%= cm r.item.try(:item).try(:total_cost), :dollars %></td>
			<td class="monitary">$<%= cm r.unit_price, :dollars %></td>
			<td class="right"><%= cm(r.quantity, :sales_order_quantity) %></td>
			<% if r.item.try(:item) %>
			<td class="right"><%= cm(r.item.item.quantity_on_hand, :sales_order_quantity, 0) %></td>
			<td class="right"><%= cm(r.item.item.quantity_committed, :sales_order_quantity, 0) %></td>
			<% else %>
			<td></td>
			<td></td>
			<% end %>
			<% end %>
			<td class="monitary">$<%= cm(r.release_price, :dollars) %></td>
		</tr>
<% end %>
	</tbody>
</table>

<% if @shippers.size > 0 %>
<h3>Shippers</h3>
<%= render 'shipping/shippers/list' %>
<% end %>
