<% include_closed_details_javascript(image_tag('arrow_collapse.gif'),image_tag('arrow_expand.gif')) %>

<%= render 'production/submenu' %>
<br />

<div class="paging">
	<%= link_to("&laquo; Previous".html_safe, inventory_report_customer_report_url(@inventory_report, @prev_customer_report)) if @prev_customer_report  %>
	<%= link_to('Top', inventory_report_customer_reports_url(@inventory_report)) %>
	<%= link_to("Next &raquo;".html_safe, 
	inventory_report_customer_report_url(@inventory_report, @next_customer_report)) if @next_customer_report %>
</div>


<h2><%= @customer_report.customer_name %></h2>

<table class="data">
	<thead>
		<tr>
			<th>Part</th>
			<th>Last Receipt</th>
			<th>Last Ship</th>
			<th>Next Receipt</th>
			<th>Next Ship</th>
			<% Production::InventoryReportQuantity.all.each do |quantity| %>
			<th><%= quantity.name %></th>
			<% end %>
		</tr>
	</thead>
	<tbody>
		<% @customer_report.item_reports.by_on_hand_cost_desc.each do |item_report| %>
		<tr>
			<td>
				<a href="#"><span class="show_closed_details" id="closed_details_<%= item_report.m2m_identity_column %>">
				<%= image_tag('arrow_collapse.gif') %>
				</span></a>
				<%= link_to item_report.part_number, item_url(item_report.m2m_identity_column) %>
			</td>
			<td><%= item_report.last_receipt_date.try(:to_s, :report_date) %></td>
			<td><%= item_report.last_ship_date.try(:to_s, :report_date) %></td>
			<td><%= item_report.next_receipt_date.try(:to_s, :report_date) %></td>
			<td><%= item_report.next_ship_date.try(:to_s, :report_date) %></td>
			<% Production::InventoryReportQuantity.all.each do |quantity| %>
			<td class="right">
				<%= cm item_report.send(quantity.total_cost_key), :rounded_dollars %>
				<div class="closed_details xclosed_details_<%= item_report.m2m_identity_column %>">
					<br /><%= cm item_report.send(quantity.quantity_key), :item_quantity %></td>
				</div>
			</td>
			<% end %>
		</tr>
		<% end %>
		<tr>
			<td class="right" colspan="5" class="right">Total</td>
			<% Production::InventoryReportQuantity.all.each do |quantity| %>
			<th class="right"><%= cm @customer_report.send(quantity.total_cost_key), :rounded_dollars %></th>
			<% end %>
		</tr>
	</tbody>
</table>
